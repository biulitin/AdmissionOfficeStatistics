[
    {
      "excel_name": "Внутренняя_отчетность_шаблон.xlsx",
      "excel_id": "internal",
      "sheet_name": "1_Обобщенная по приему",
      "sheet_id": "general",
      "sql": "select SP.sp_Name as c1_1v3_5, KL.kl_name as c2_2v3_5, 'Подано заявлений' as c3_3v_3_3, 'Зачислено' as c3_3v4_4, 'План приема' as c3_3v_5_5, (select count(*) from AbitSp, Speciality where (AbitSp.kl_id = KL.kl_id and AbitSp.sp_id = Speciality.sp_id and Speciality.sp_Name = SP.sp_Name)) as c4_4v3_3, (select count(*) from AbitSp, Speciality where (AbitSp.kl_id = KL.kl_id and AbitSp.sp_id = Speciality.sp_id and Speciality.sp_Name = SP.sp_Name and AbitSp.f = 1)) as c5_5v3_3, (select count(*) from AbitSp, Speciality where (AbitSp.kl_id = KL.kl_id and AbitSp.sp_id = Speciality.sp_id and Speciality.sp_Name = SP.sp_Name and AbitSp.f = 2)) as c6_6v3_3, (select count(*) from AbitSp, Speciality where (AbitSp.kl_id = KL.kl_id and AbitSp.sp_id = Speciality.sp_id and Speciality.sp_Name = SP.sp_Name and isNULL(Speciality.sp_C,'') != '')) as c7_7v3_3, (select count(*) from AbitSp, Abit where (Abit.aid = AbitSp.aid and AbitSp.kl_id = KL.kl_id and AbitSp.sp_id = SP.sp_id and AbitSp.f = 1 and Abit.l1_id>0)) as c8_8v3_3, (select count(*) from AbitSp, Abit where (Abit.aid = AbitSp.aid and AbitSp.kl_id = KL.kl_id and AbitSp.sp_id = SP.sp_id and AbitSp.f = 1 and Abit.l_id>0)) as c9_9v3_3, 0 as c10_10v3_3, (select count(*) from AbitSp, Abit where (Abit.aid = AbitSp.aid and AbitSp.kl_id = KL.kl_id and AbitSp.sp_id = SP.sp_id and Abit.l2_id>0)) as c11_11v3_3, (select count(*) from AbitSp, Speciality where (AbitSp.kl_id = KL.kl_id and AbitSp.sp_id = Speciality.sp_id and Speciality.sp_Name = SP.sp_Name and not exists(select * from AbitEGE where (AbitSp.aid = AbitEGE.aid and (AbitEGE.d_ex is not null or AbitEGE.gr is not null))))) as c12_12v3_3, (select count(*) from AbitSp, Speciality where (AbitSp.kl_id = KL.kl_id and AbitSp.sp_id = Speciality.sp_id and Speciality.sp_Name = SP.sp_Name and exists(select * from AbitEGE where (AbitSp.aid = AbitEGE.aid and (AbitEGE.d_ex is not null or AbitEGE.gr is not null))))) as c13_13v3_3, (select count(*) from Abit, AbitSp, Level_edu, Speciality where (Abit.aid = AbitSp.aid and Abit.leid = Level_edu.leid and AbitSp.kl_id = KL.kl_id and AbitSp.sp_id = Speciality.sp_id and Speciality.sp_Name = SP.sp_Name and LOWER(Level_edu.leName) like '%высшее%')) as c14_14v3_3, (select count(*) from Abit, AbitSp, Level_edu, Speciality where (Abit.aid = AbitSp.aid and Abit.leid = Level_edu.leid and AbitSp.kl_id = KL.kl_id and AbitSp.sp_id = Speciality.sp_id and Speciality.sp_Name = SP.sp_Name and LOWER(Level_edu.leName) like '%среднее проф%')) as c15_15v3_3, (select count(*) from AbitSp, Speciality where (AbitSp.kl_id = KL.kl_id and AbitSp.sp_id = Speciality.sp_id and Speciality.sp_Name = SP.sp_Name and (AbitSp.z>0 or AbitSp.z_2014>0))) as c4_4v4_4, (select count(*) from AbitSp, Speciality where (AbitSp.kl_id = KL.kl_id and AbitSp.sp_id = Speciality.sp_id and Speciality.sp_Name = SP.sp_Name and AbitSp.f = 1 and (AbitSp.z>0 or (AbitSp.z_2014>0 and AbitSp.z_2014<7)))) as c5_5v4_4, (select count(*) from AbitSp, Speciality where (AbitSp.kl_id = KL.kl_id and AbitSp.sp_id = Speciality.sp_id and Speciality.sp_Name = SP.sp_Name and AbitSp.f = 2 and (AbitSp.z>0 or AbitSp.z_2014=7))) as c6_6v4_4, (select count(*) from AbitSp, Speciality where (AbitSp.kl_id = KL.kl_id and AbitSp.sp_id = Speciality.sp_id and Speciality.sp_Name = SP.sp_Name and isNULL(Speciality.sp_C,'') != '') and (AbitSp.z=1 or AbitSp.z_2014=4)) as c7_7v4_4, (select count(*) from AbitSp, Abit where (Abit.aid = AbitSp.aid and AbitSp.kl_id = KL.kl_id and AbitSp.sp_id = SP.sp_id and AbitSp.f = 1 and Abit.l1_id>0) and (AbitSp.z=1 or AbitSp.z_2014=4)) as c8_8v4_4, (select count(*) from AbitSp, Abit where (Abit.aid = AbitSp.aid and AbitSp.kl_id = KL.kl_id and AbitSp.sp_id = SP.sp_id and AbitSp.f = 1 and Abit.l_id>0) and (AbitSp.z=1 or AbitSp.z_2014=4)) as c9_9v4_4, 0 as c10_10v4_4, (select count(*) from AbitSp, Abit where (Abit.aid = AbitSp.aid and AbitSp.kl_id = KL.kl_id and AbitSp.sp_id = SP.sp_id and Abit.l2_id>0) and (AbitSp.z>0 or AbitSp.z_2014>0)) as c11_11v4_4, (select count(*) from AbitSp, Speciality where (AbitSp.kl_id = KL.kl_id and AbitSp.sp_id = Speciality.sp_id and Speciality.sp_Name = SP.sp_Name and not exists(select * from AbitEGE where (AbitSp.aid = AbitEGE.aid and (AbitEGE.d_ex is not null or AbitEGE.gr is not null))) and (AbitSp.z>0 or AbitSp.z_2014>0))) as c12_12v4_4, (select count(*) from AbitSp, Speciality where (AbitSp.kl_id = KL.kl_id and AbitSp.sp_id = Speciality.sp_id and Speciality.sp_Name = SP.sp_Name and exists(select * from AbitEGE where (AbitSp.aid = AbitEGE.aid and (AbitEGE.d_ex is not null or AbitEGE.gr is not null))) and (AbitSp.z>0 or AbitSp.z_2014>0))) as c13_13v4_4, (select count(*) from Abit, AbitSp, Level_edu, Speciality where (Abit.aid = AbitSp.aid and Abit.leid = Level_edu.leid and AbitSp.kl_id = KL.kl_id and AbitSp.sp_id = Speciality.sp_id and Speciality.sp_Name = SP.sp_Name and LOWER(Level_edu.leName) like '%высшее%' and (AbitSp.z>0 or AbitSp.z_2014>0))) as c14_14v4_4, (select count(*) from Abit, AbitSp, Level_edu, Speciality where (Abit.aid = AbitSp.aid and Abit.leid = Level_edu.leid and AbitSp.kl_id = KL.kl_id and AbitSp.sp_id = Speciality.sp_id and Speciality.sp_Name = SP.sp_Name and LOWER(Level_edu.leName) like '%среднее проф%' and (AbitSp.z>0 or AbitSp.z_2014>0))) as c15_15v4_4, PP.Qo + PP.F as c4_4v5_5, PP.Qo as c5_5v5_5, PP.F as c6_6v5_5, (select isNULL(sum(Qo), 0) from PlanPr, Speciality where (PlanPr.kl_id = KL.kl_id and PlanPr.sp_id = Speciality.sp_id and Speciality.sp_Name = SP.sp_Name and isNULL(Speciality.sp_C,'') != '')) as c7_7v5_5 from Speciality SP, KindLearn KL, PlanPr PP where ( SP.sp_id = PP.sp_id and KL.kl_id = PP.kl_id and isNULL(SP.sp_C,'') = '') order by SP.sp_Name, KL.kl_name;" 
    },
    {
    	"excel_name": "Внутренняя_отчетность_шаблон.xlsx",
    	"excel_id": "internal",
    	"sheet_name": "2_По целевым орг-ям",
    	"sheet_id": "celevoi",
    	"sql": "select SP.sp_Name as c1_1v2_2, SP.sp_C as c2_2v2_2, (select count(*) from AbitSp where AbitSp.sp_id = SP.sp_id) as c3_3v2_2, (select count(*) FROM AbitSp where (AbitSp.sp_id = SP.sp_id) and (AbitSp.z=1 or AbitSp.z_2014=4)) as c4_4v2_2 from Speciality SP, PlanPr PP where ( SP.sp_id = PP.sp_id and isNULL(SP.sp_C,'') != '') order by SP.sp_Name, SP.sp_C;"
    },
    {
    	"excel_name": "Внутренняя_отчетность_шаблон.xlsx",
    	"excel_id": "internal",
    	"sheet_name": "3_Обобщенная по приему+Уч3",
    	"sheet_id": "general+",
    	"sql": ""
    },
    {
    	"excel_name": "Внутренняя_отчетность_шаблон.xlsx",
    	"excel_id": "internal",
    	"sheet_name": "4_Анкета_по приему",
    	"sheet_id": "ank_priem",
    	"sql": ""
    },
    {
    	"excel_name": "Внутренняя_отчетность_шаблон.xlsx",
    	"excel_id": "internal",
    	"sheet_name": "5_Анкета_БВИ_олимп",
    	"sheet_id": "ank_bvi",
    	"sql": ""
    },
    {
    	"excel_name": "Внутренняя_отчетность_шаблон.xlsx",
    	"excel_id": "internal",
    	"sheet_name": "6_Анкета_квоты",
    	"sheet_id": "ank_kvota",
    	"sql": ""
    },
    {
    	"excel_name": "Внутренняя_отчетность_шаблон.xlsx",
    	"excel_id": "internal",
    	"sheet_name": "7_Анкета_целевики",
    	"sheet_id": "",
    	"sql": ""
    },
    {
    	"excel_name": "Внутренняя_отчетность_шаблон.xlsx",
    	"excel_id": "internal",
    	"sheet_name": "ank_celecoi",
    	"sheet_id": "",
    	"sql": ""
    },
    {
    	"excel_name": "Внутренняя_отчетность_шаблон.xlsx",
    	"excel_id": "internal",
    	"sheet_name": "8_Анкета_проход.балл",
    	"sheet_id": "ank_ball",
    	"sql": ""
    }
]